package core.agents.util;

import suport.financial.partternsCandleStick.CandleStick;
import core.agents.ConversationsID;
import jade.core.AID;
import jade.core.Agent;
import jade.core.behaviours.CyclicBehaviour;
import jade.core.behaviours.TickerBehaviour;
import jade.domain.DFService;
import jade.domain.FIPAException;
import jade.domain.FIPAAgentManagement.DFAgentDescription;
import jade.lang.acl.ACLMessage;
import jade.lang.acl.UnreadableException;

public class AgentB extends Agent {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

	public void setup() {
		DFAgentDescription agentDescriptor = new DFAgentDescription();
		agentDescriptor.setName(getAID());

		try {
			DFService.register(this, agentDescriptor);
			
			System.out.println("agente "+this.getName());
			addBehaviour(new TickerBehaviour(this,4000)
			{
				private static final long serialVersionUID = 1L;

				@Override
				protected void onTick()
				{
					try
					{
						ACLMessage mensagem = new ACLMessage(ACLMessage.INFORM);
						mensagem.addReceiver(new AID("agenteA", AID.ISLOCALNAME));
						mensagem.setConversationId(ConversationsID.CREATE_EXPERTS);
						mensagem.setConversationId("MGS1");
						mensagem.setContent("INFORM");
						
						System.out.println("Pedido "+mensagem.getContent()+" Feito");
									
						ACLMessage m2 = new ACLMessage(ACLMessage.CFP);
						m2.addReceiver(new AID("agenteA", AID.ISLOCALNAME));
						m2.setConversationId("MGS2");
						m2.setContent("CFP");
						
						System.out.println("Pedido "+m2.getContent()+" Feito");
						
						
						ACLMessage m3 = new ACLMessage(ACLMessage.AGREE);
						m3.addReceiver(new AID("agenteA", AID.ISLOCALNAME));
						m3.setConversationId("MGS2");
						m3.setContent("AGREE");
						
						System.out.println("Pedido "+m3.getContent()+" Feito");
						
						myAgent.send(mensagem);
						myAgent.send(m2);
						myAgent.send(m3);
						
					}catch (Exception e)
					{
						// TODO: handle exception
					}
					
				}
			});

		} catch (FIPAException e) {

			e.printStackTrace();
		}
	}

	public void takeDown() 
	{

	}

//		public Comportamento(Agent agent, int time) {
//			// TODO Auto-generated constructor stub
//		}
//		public void onTicker() {
//			try {
//
//				ACLMessage mensagem = new ACLMessage(ACLMessage.CFP);
//				mensagem.addReceiver(new AID("simulator", AID.ISLOCALNAME));
//				mensagem.setConversationId(ConversationsID.SIMULATION_REQUEST);
//				mensagem.setContent("BAZA3.SA");
//
//				if (!aceitaProposta)
//					myAgent.send(mensagem);
//
//				MessageTemplate template = new MessageTemplate(
//						(MatchExpression) MessageTemplate
//								.MatchPerformative(ACLMessage.PROPOSE));
//				ACLMessage reciver = myAgent.receive(template);
//
//				if (reciver != null) {
//					System.out.println("Recebi " + contador + " proposta(s) ");
//					System.out.println("==>" + reciver.getContent());
//
//					if (contador == 4) {
//						ACLMessage resposta = reciver.createReply();
//						resposta.setPerformative(ACLMessage.ACCEPT_PROPOSAL);
//						finishBehavior = true;
//					} else {
//						ACLMessage resposta = reciver.createReply();
//						resposta.setPerformative(ACLMessage.REJECT_PROPOSAL);
//					}
//
//					contador++;
//
//				}
//
//			} catch (Exception e) {
//				e.printStackTrace();
//			}
//
//		}
}
