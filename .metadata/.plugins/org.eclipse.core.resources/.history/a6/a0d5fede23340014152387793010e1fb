package rcs.core.agents;



import jade.core.Agent;
import jade.core.behaviours.TickerBehaviour;
import jade.domain.DFService;
import jade.domain.FIPAAgentManagement.DFAgentDescription;
import jade.wrapper.AgentController;
import jade.wrapper.PlatformController;
import rcs.suport.util.database.JadeConnectToMongoTest;

public class Manager  extends Agent{
	
	private JadeConnectToMongoTest jadeConnect;
	private int aux;
	protected void setup()
	{
		try{
			//create the agent description of ifself
			DFAgentDescription dfd=new DFAgentDescription();
			dfd.setName(getAID());
			DFService.register(this, dfd);
			
			System.out.println("I'm live... My name is Manager");
			System.out.println(this.getName());
						
			//System.out.println("Starting the UIFrame");
			//FrameTestAgentGestor UIFrame=new FrameTestAgentGestor(this);
			
			//MongoConnection
		     jadeConnect=new JadeConnectToMongoTest();
			 aux=0;
			addBehaviour(new TickerBehaviour(this,10) {
				
				
				@Override
				protected void onTick() {


					
					if(jadeConnect.createNewExpert() && aux==0)
					{
						createExpertAgents(1000.f, "Expert");
						aux=1;
					} else if(!jadeConnect.createNewExpert()&& aux==1)
					{
						dropExpertAgent("Expert");
						aux=0;
					}
										
				}
			});
			
		}catch (Exception e)
		{
			e.printStackTrace();
		}
	}
	

public void createExpertAgents(double value,String name)
{
	PlatformController container=getContainerController();
	try {
		AgentController  agentController=container.createNewAgent(name, "rcs.core.agents.Expert", null);
		agentController.start();
		
	} 
	catch (Exception e) 
	{
		e.printStackTrace();
	}
	
}
public void dropExpertAgent (String name)
{
	PlatformController container=getContainerController();
	try
	{
		AgentController agentController=container.getAgent(name);
		agentController.kill();
	}catch(Exception e)
	{
		e.printStackTrace();
	}
}


}
